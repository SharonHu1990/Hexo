<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="iOS,知识小集," />





  <link rel="alternate" href="/atom.xml" title="Sharon's World" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/uploads/sun.ico?v=5.1.0" />






<meta name="description" content="layoutSubviews官方文档引用：

You should override this method only if the autoresizing andconstraint-based behaviors of the subviews do not offer the behavioryou want.

我的理解是：    在subview的autoresizing和constr">
<meta property="og:type" content="article">
<meta property="og:title" content="About Laying out Subviews">
<meta property="og:url" content="http://yoursite.com/About Laying out Subviews.html">
<meta property="og:site_name" content="Sharon's World">
<meta property="og:description" content="layoutSubviews官方文档引用：

You should override this method only if the autoresizing andconstraint-based behaviors of the subviews do not offer the behavioryou want.

我的理解是：    在subview的autoresizing和constr">
<meta property="og:updated_time" content="2016-04-13T06:46:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="About Laying out Subviews">
<meta name="twitter:description" content="layoutSubviews官方文档引用：

You should override this method only if the autoresizing andconstraint-based behaviors of the subviews do not offer the behavioryou want.

我的理解是：    在subview的autoresizing和constr">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/About Laying out Subviews.html"/>





  <title> About Laying out Subviews | Sharon's World </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?06fa334b387f01741a8ceb0eb36c3c1d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Sharon's World</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">Think deeply，work hard.</h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/About Laying out Subviews.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Sharon Hu">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Sharon's World">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Sharon's World" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                About Laying out Subviews
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Дата создания записи" itemprop="dateCreated datePublished" datetime="2016-04-11T16:30:39+08:00">
                Apr 11 2016
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/About Laying out Subviews.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="About Laying out Subviews.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="layoutSubviews">layoutSubviews</h2><p>官方文档引用：</p>
<blockquote>
<p>You should override this method only if the autoresizing and<br>constraint-based behaviors of the subviews do not offer the behavior<br>you want.</p>
</blockquote>
<p>我的理解是：<br>    在subview的<code>autoresizing</code>和<code>constraint</code>不满足你的要求时，可以重写<code>layoutSubviews</code>。假设一个屏幕从竖屏变为横屏，本来图文单元是图片在上，文字在下面，可能就变为了左右结构；这是无论自动适配还是自动布局都解决不了，就只能重写layoutSubviews函数了。</p>
<a id="more"></a>
<p>官方文档引用:</p>
<blockquote>
<p>You should not call this method directly.</p>
</blockquote>
<p>不应该直接调用这个方法！</p>
<p>官方不建议我们直接调用<code>layoutSubviews</code>，其中的具体原因我想的不是特别明白，但是，我觉得可以换个角度来思考这个问题，来想想什么时候layoutSubviews会被自动调用，可能会对理解官方不建议直接调用<code>layoutSubviews</code>有帮助。</p>
<p><code>layoutSubviews</code>在以下情况下会被调用：</p>
<ul>
<li><code>init</code>初始化不会触发<code>layoutSubviews</code>,但是使用<code>initWithFrame</code> 进行初始化时，当rect的值不为<code>CGRectZero</code>时,也会触发；</li>
<li><code>addSubview</code>会触发<code>layoutSubviews</code>;</li>
<li>设置view的Frame会触发<code>layoutSubviews</code>，当然前提是frame的值设置前后发生了变化;</li>
<li>滚动一个<code>UIScrollView</code>及其派生类会触发<code>layoutSubviews</code>;</li>
<li>旋转Screen会触发父<code>UIView</code>上的<code>layoutSubviews</code>事件</li>
<li>改变一个<code>UIView</code>大小的时候也会触发父<code>UIView</code>上的<code>layoutSubviews</code>事件.</li>
</ul>
<h2 id="setNeedsLayout">setNeedsLayout</h2><p>官方文档引用：</p>
<blockquote>
<p>Invalidates the current layout of the receiver and triggers a layout update during the next update cycle.</p>
<p>Call this method on your application’s main thread when you want to adjust the layout of a view’s subviews. This method makes a note of<br>the request and returns immediately. Because this method does not<br>force an immediate update, but instead waits for the next update<br>cycle, you can use it to invalidate the layout of multiple views<br>before any of those views are updated. This behavior allows you to<br>consolidate all of your layout updates to one update cycle, which is<br>usually better for performance.</p>
</blockquote>
<p><code>setNeedsLayout</code>在UIView对象中设置一个标记，用来表示view需要被布局。这将使<code>layoutSubviews</code>方法在<strong>下一次重绘发生之前</strong>被异步调用。注意，因为UIView的<code>autoresizesSubviews</code>属性，在很多情况下，你不需要明确地调用<code>setNeedsLayout</code>，因为如果UIView的<code>autoresizesSubviews</code>被设置（默认被设置为YES），那么，当它的frame发生变化的时候就会自动去布局它的subViews。</p>
<p>此方法会将view当前的layout设置为无效的，并在下一个upadte cycle里去触发layout更新。</p>
<p><code>setNeedsLayout</code>在以下情况下需要被调用：（帮助理解）</p>
<ul>
<li>If you manipulated constraints directly, call setNeedsLayout.</li>
<li>If you changed some conditions (like offsets or smth) which would change constraints in your overridden <code>updateConstraints</code> method (a recommended way to change constraints, btw), call <code>setNeedsUpdateConstraints</code>, and most of the time, setNeedsLayout after that.</li>
<li>If you need any of the actions above to have immediate effect—e.g. when your need to learn new frame height after a layout pass—append it with a layoutIfNeeded.</li>
</ul>
<h2 id="layoutIfNeeded">layoutIfNeeded</h2><p>官方解释：</p>
<blockquote>
<p>Lays out the subviews immediately.</p>
<p>Use this method to force the layout of subviews before drawing. Using<br>the view that receives the message as the root view, this method lays<br>out the view subtree starting at the root.</p>
</blockquote>
<p>使用此方法强制立即进行layout,从当前view开始，此方法会遍历整个view层次(包括superviews)请求layout。因此，调用此方法会强制整个view层次布局。</p>
<p>如果要立即刷新，要先调用<code>[view setNeedsLayout]</code>，把标记设为需要布局，然后马上调用<code>[view layoutIfNeeded]</code>，实现布局<br>在视图第一次显示之前，标记总是“需要刷新”的，可以直接调用<code>[view layoutIfNeeded]</code>。</p>
<p>一个Demo:<a href="https://github.com/SharonHu1990/MyDemos/tree/master/LayoutSubViewsTest" target="_blank" rel="external">https://github.com/SharonHu1990/MyDemos/tree/master/LayoutSubViewsTest</a></p>
<p>在这个Demo中，一个UILabel被放在左上角，中间放一个button，点击button实现label左右移动，带有回弹动画。在xib中已经绑定了约束。</p>
<p>在button的action中，通过修改label的constraint.constant值实现位置的改变。代码如下：</p>
<pre><code>- (IBAction)<span class="string">touchButton:</span>(id)sender {
    <span class="keyword">if</span> (!_hasDistance) {
        _hasDistance = YES;
        _leftConstraint.constant = <span class="number">100</span>;

    }<span class="keyword">else</span>{
        _hasDistance = NO;
        _leftConstraint.constant = <span class="number">0</span>;
    }

    [UIView <span class="string">animateWithDuration:</span><span class="number">0.8</span> <span class="string">delay:</span><span class="number">0</span> <span class="string">usingSpringWithDamping:</span><span class="number">0.5</span> <span class="string">initialSpringVelocity:</span><span class="number">0.5</span> <span class="string">options:</span>UIViewAnimationOptionAllowAnimatedContent <span class="string">animations:</span>^{
        [self.view layoutIfNeeded];<span class="comment">//立即实现布局，如果不写这一句就没有动画效果</span>
    } <span class="string">completion:</span>nil];
}
</code></pre><p>可以看到，在animations中写了<code>[self.view layoutIfNeeded]</code>,如果没有这句代码，label只是简单地移动了位置（即只是执行了_leftConstraint.constant = XX），而没有动画效果。</p>
<h2 id="setNeedsDisplay">setNeedsDisplay</h2><p>官方解释：</p>
<blockquote>
<p>Marks the receiver’s entire bounds rectangle as needing to be redrawn.</p>
<p>You can use this method or the <code>setNeedsDisplayInRect:</code> to notify the<br>system that your view’s contents need to be redrawn. This method makes<br>a note of the request and returns immediately. The view is not<br>actually redrawn until the next drawing cycle, at which point all<br>invalidated views are updated.</p>
<p>You should use this method to request that a view be redrawn only when<br>the content or appearance of the view change.</p>
</blockquote>
<p>一个使用<code>setNeedsDisplay</code> 的例子:<br><a href="http://blog.fujianjin6471.com/2015/06/11/An-example-of-when-should-setNeedsDisplay-be-called.html" target="_blank" rel="external">http://blog.fujianjin6471.com/2015/06/11/An-example-of-when-should-setNeedsDisplay-be-called.html</a></p>
<p><code>setNeedsLayout</code> 和 <code>setNeedsDisplay</code>的区别？<br>首先两个方法都是异步执行的。而setNeedsDisplay会自动调用<code>drawRect</code>方法，这样可以拿到<code>UIGraphicsGetCurrentContext</code>，就可以画画了。而<code>setNeedsLayout</code>会默认调用<code>layoutSubViews</code>，就可以处理子视图中的一些数据。<br>综上所述，<code>setNeedsDisplay</code>方便绘图，而<code>setNeedsLayout</code>方便出来数据。</p>
<h2 id="requiresConstraintBasedLayout">requiresConstraintBasedLayout</h2><p>官方文档：</p>
<blockquote>
<p>A Boolean value that indicates whether the receiver depends on the<br>constraint-based layout system.</p>
<p>Custom views should override this to return YES if they cannot layout<br>correctly using autoresizing.</p>
</blockquote>
<p>UIView.h中是这样说的(这个解释更加帮助了理解)：</p>
<blockquote>
<p>constraint-based layout engages lazily when someone tries to use it<br>(e.g., adds a constraint to a view).  If you do all of your constraint<br>set up in -updateConstraints, you might never even receive<br>updateConstraints if no one makes a constraint.  To fix this chicken<br>and egg problem, override this method to return YES if your view needs<br>the window to use constraint-based layout.</p>
</blockquote>
<p>意思就是：基于约束的布局是懒触发的(例如：给一个view添加约束)。如果把所有的约束放在 updateConstraints中，并且没有添加任何约束，那么你将不会获得updateConstraint。为了解决这个鸡和蛋的问题，重写+requiresConstraintBasedLayout 并且返回YES就是明确告诉系统：虽然我之前没有添加约束,但我确实是基于约束的布局！这样可以保证系统一定会调用 -updateConstraints 方法 从而正确添加约束.</p>
<p>一篇<a href="https://www.objc.io/issues/3-views/advanced-auto-layout-toolbox/#local_constraints" target="_blank" rel="external">objc.io</a> 中的文章也建议在实现使用了constraint的自定义View时，重写+requiresConstraintBasedLayout并返回YES，以声明view是依赖于AutoLayout的。</p>
<p>另外一篇参考文章：<a href="http://www.edwardhuynh.com/blog/2013/11/24/the-mystery-of-the-requiresconstraintbasedlayout/" target="_blank" rel="external">The Mystery of the +requiresConstraintBasedLayout</a></p>
<h2 id="translatesAutoresizingMaskIntoConstraints">translatesAutoresizingMaskIntoConstraints</h2><p>在代码中创建view及其派生类，如果需要给他们添加约束，就将translatesAutoresizingMaskIntoConstraints 设为NO。原因：The reason for this is that iOS creates constraints for you that match the new view’s size and position, and if you try to add your own constraints these will conflict and your app will break.</p>
<p>官方文档：</p>
<blockquote>
<p>A Boolean value that determines whether the view’s autoresizing mask<br>is translated into Auto Layout constraints</p>
<p>If this property’s value is YES, the system creates a set of<br>constraints that duplicate the behavior specified by the view’s<br>autoresizing mask. This also lets you modify the view’s size and<br>location using the view’s frame, bounds, or center properties,<br>allowing you to create a static, frame-based layout within Auto<br>Layout.</p>
<p>Note that the autoresizing mask constraints fully specify the view’s<br>size and position; therefore, you cannot add additional constraints to<br>modify this size or position without introducing conflicts. If you<br>want to use Auto Layout to dynamically calculate the size and position<br>of your view, you must set this property to NO, and then provide a non<br>ambiguous, nonconflicting set of constraints for the view.</p>
<p>By default, the property is set to YES for any view you<br>programmatically create. If you add views in Interface Builder, the<br>system automatically sets this property to NO.</p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/uploads/wechatPay.png" alt="Sharon Hu WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/uploads/alipay.png" alt="Sharon Hu Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/知识小集/" rel="tag"># 知识小集</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/什么时候应该重写viewDidLayoutSubviews.html" rel="next" title="什么时候应该重写viewDidLayoutSubviews?">
                <i class="fa fa-chevron-left"></i> 什么时候应该重写viewDidLayoutSubviews?
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/UITableView-section-header-不固定.html" rel="prev" title="UITableView section header 不固定">
                UITableView section header 不固定 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>

          
          </div>
          

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="About Laying out Subviews.html"
           data-title="About Laying out Subviews" data-url="http://yoursite.com/About Laying out Subviews.html">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Sharon Hu" />
          <p class="site-author-name" itemprop="name">Sharon Hu</p>
          <p class="site-description motion-element" itemprop="description">sharon's blog</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/SharonHu1990" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.weibo.com/sharonhu0813" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/hu-sharon-1" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://sharon0325.lofter.com/" target="_blank" title="LOFTER">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  LOFTER
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#layoutSubviews"><span class="nav-number">1.</span> <span class="nav-text">layoutSubviews</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setNeedsLayout"><span class="nav-number">2.</span> <span class="nav-text">setNeedsLayout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#layoutIfNeeded"><span class="nav-number">3.</span> <span class="nav-text">layoutIfNeeded</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setNeedsDisplay"><span class="nav-number">4.</span> <span class="nav-text">setNeedsDisplay</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#requiresConstraintBasedLayout"><span class="nav-number">5.</span> <span class="nav-text">requiresConstraintBasedLayout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#translatesAutoresizingMaskIntoConstraints"><span class="nav-number">6.</span> <span class="nav-text">translatesAutoresizingMaskIntoConstraints</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sharon Hu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"sharonhu1990"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  












  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


</body>
</html>
